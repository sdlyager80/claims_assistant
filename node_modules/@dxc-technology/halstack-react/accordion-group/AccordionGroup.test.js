"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _react = _interopRequireDefault(require("react"));

var _react2 = require("@testing-library/react");

var _AccordionGroup = _interopRequireDefault(require("./AccordionGroup"));

describe("Accordion component tests", function () {
  test("Uncontrolled accordion group calls correct function on click", function () {
    var onActiveChange = jest.fn();

    var _render = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"], {
      margin: "large",
      onActiveChange: onActiveChange
    }, /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion1",
      padding: "medium",
      margin: "large"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse malesuada lacus ex, sit amet blandit leo lobortis eget.")), /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion2",
      padding: "medium"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse malesuada lacus ex, sit amet blandit leo lobortis eget.")))),
        getByText = _render.getByText,
        getAllByRole = _render.getAllByRole;

    expect(getAllByRole("button")[0].getAttribute("aria-expanded")).toBe("false");
    expect(getAllByRole("button")[1].getAttribute("aria-expanded")).toBe("false");

    _react2.fireEvent.click(getByText("Accordion1"));

    expect(onActiveChange).toHaveBeenCalled();
    expect(getAllByRole("button")[0].getAttribute("aria-expanded")).toBe("true");
    expect(getAllByRole("button")[1].getAttribute("aria-expanded")).toBe("false");
  });
  test("Uncontrolled accordion group renders initially with an accordion expanded using defaultIndexActive", function () {
    var _render2 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"], {
      defaultIndexActive: 1
    }, /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion1",
      padding: "medium"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "First accordion")), /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion2",
      padding: "medium"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Second accordion")))),
        queryByText = _render2.queryByText,
        getByText = _render2.getByText,
        getAllByRole = _render2.getAllByRole;

    expect(getAllByRole("button")[0].getAttribute("aria-expanded")).toBe("false");
    expect(getAllByRole("button")[1].getAttribute("aria-expanded")).toBe("true");
    expect(getByText("Second accordion")).toBeTruthy();
    expect(queryByText("First accordion")).toBeFalsy();
  });
  test("Controlled accordion with indexActive change", function () {
    var onActiveChange = jest.fn();

    var _render3 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"], {
      margin: "large",
      indexActive: 1,
      onActiveChange: onActiveChange
    }, /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion1",
      padding: "medium",
      margin: "large"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Text1")), /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion2",
      padding: "medium"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Text2")))),
        queryByText = _render3.queryByText,
        getByText = _render3.getByText,
        getAllByRole = _render3.getAllByRole,
        rerender = _render3.rerender;

    expect(queryByText("Text1")).toBeFalsy();
    expect(getByText("Text2")).toBeTruthy();

    _react2.fireEvent.click(getByText("Accordion1"));

    _react2.fireEvent.click(getByText("Accordion2"));

    expect(onActiveChange.mock.calls[0][0]).toBe(0);
    expect(onActiveChange.mock.calls[1][0]).toBe(1);
    expect(getAllByRole("button")[0].getAttribute("aria-expanded")).toBe("false");
    expect(getAllByRole("button")[1].getAttribute("aria-expanded")).toBe("true");
    rerender( /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"], {
      margin: "large",
      indexActive: 0,
      onActiveChange: onActiveChange
    }, /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion1",
      padding: "medium",
      margin: "large"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Text1")), /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion2",
      padding: "medium"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Text2"))));
    expect(getAllByRole("button")[0].getAttribute("aria-expanded")).toBe("true");
    expect(getAllByRole("button")[1].getAttribute("aria-expanded")).toBe("false");
  });
  test("Disabled uncontrolled accordion group", function () {
    var onActiveChange = jest.fn();

    var _render4 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"], {
      margin: "large",
      onActiveChange: onActiveChange,
      disabled: true
    }, /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion1",
      padding: "medium",
      margin: "large"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Text1")), /*#__PURE__*/_react["default"].createElement(_AccordionGroup["default"].Accordion, {
      label: "Accordion2",
      padding: "medium"
    }, /*#__PURE__*/_react["default"].createElement("div", null, "Text2")))),
        getByText = _render4.getByText;

    _react2.fireEvent.click(getByText("Accordion1"));

    _react2.fireEvent.click(getByText("Accordion2"));

    expect(onActiveChange).toHaveBeenCalledTimes(0);
  });
});