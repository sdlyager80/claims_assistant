"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _react = _interopRequireDefault(require("react"));

var _react2 = require("@testing-library/react");

var _Accordion = _interopRequireDefault(require("./Accordion"));

describe("Accordion component tests", function () {
  test("Renders with correct aria accessibility attributes", function () {
    var _render = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Accordion["default"], {
      label: "Accordion",
      defaultIsExpanded: true
    }, /*#__PURE__*/_react["default"].createElement("div", null, "test-expanded"))),
        getByRole = _render.getByRole;

    var accordion = getByRole("button");
    var panel = getByRole("region");
    expect(accordion.getAttribute("aria-controls")).toBe(panel.id);
    expect(panel.getAttribute("aria-labelledby")).toBe(accordion.id);
  });
  test("Renders expanded by default when it is uncontrolled", function () {
    var _render2 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Accordion["default"], {
      label: "Accordion",
      defaultIsExpanded: true
    }, /*#__PURE__*/_react["default"].createElement("div", null, "test-expanded"))),
        getByRole = _render2.getByRole;

    var accordion = getByRole("button");
    expect(accordion.getAttribute("aria-expanded")).toBe("true");
  });
  test("Calls correct function on click", function () {
    var onChange = jest.fn();

    var _render3 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Accordion["default"], {
      label: "Accordion",
      onChange: onChange
    })),
        getByText = _render3.getByText;

    _react2.fireEvent.click(getByText("Accordion"));

    expect(onChange).toHaveBeenCalled();
  });
  test("Controlled accordion", function () {
    var onChange = jest.fn();

    var _render4 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Accordion["default"], {
      label: "Accordion",
      onChange: onChange,
      isExpanded: true
    })),
        getByText = _render4.getByText,
        getByRole = _render4.getByRole;

    expect(getByRole("button").getAttribute("aria-expanded")).toBe("true");

    _react2.fireEvent.click(getByText("Accordion"));

    _react2.fireEvent.click(getByText("Accordion"));

    _react2.fireEvent.click(getByText("Accordion"));

    expect(onChange).toHaveBeenCalledTimes(3);
    expect(onChange.mock.calls[0][0]).toBe(false);
    expect(onChange.mock.calls[1][0]).toBe(false);
    expect(onChange.mock.calls[2][0]).toBe(false);
  });
});