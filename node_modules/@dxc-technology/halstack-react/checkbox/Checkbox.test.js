"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _react = _interopRequireDefault(require("react"));

var _react2 = require("@testing-library/react");

var _userEvent = _interopRequireDefault(require("@testing-library/user-event"));

var _Checkbox = _interopRequireDefault(require("./Checkbox"));

describe("Checkbox component tests", function () {
  test("Checkbox renders with correct aria-labelledby and aria-required", function () {
    var _render = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Checkbox["default"], {
      label: "Checkbox"
    })),
        getByText = _render.getByText,
        getByRole = _render.getByRole;

    var labelId = getByText("Checkbox").getAttribute("id");
    expect(getByRole("checkbox").getAttribute("aria-labelledby")).toBe(labelId);
    expect(getByRole("checkbox").getAttribute("aria-required")).toBe("true");
  });
  test("Optional checkbox renders with correct aria-required", function () {
    var _render2 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Checkbox["default"], {
      label: "Checkbox",
      optional: true
    })),
        getByRole = _render2.getByRole;

    expect(getByRole("checkbox").getAttribute("aria-required")).toBe("false");
  });
  test("Calls correct function on click", function () {
    var onChange = jest.fn();

    var _render3 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Checkbox["default"], {
      label: "Checkbox",
      onChange: onChange
    })),
        getByText = _render3.getByText;

    _react2.fireEvent.click(getByText("Checkbox"));

    expect(onChange).toHaveBeenCalled();
  });
  test("Uncontrolled checkbox", function () {
    var onChange = jest.fn();
    var component = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Checkbox["default"], {
      label: "Checkbox",
      onChange: onChange,
      name: "test"
    }));
    var visibleCheckbox = component.getByText("Checkbox");
    var input = component.getByRole("checkbox");
    var submitInput = component.container.querySelector("input[name=\"test\"]");
    expect(input.getAttribute("aria-checked")).toBe("false");
    expect(submitInput.checked).toBe(false);

    _react2.fireEvent.click(visibleCheckbox);

    expect(onChange).toHaveBeenCalled();
    expect(onChange).toHaveBeenCalledWith(true);
    expect(input.getAttribute("aria-checked")).toBe("true");
    expect(submitInput.checked).toBe(true);
  });
  test("Controlled checkbox", function () {
    var onChange = jest.fn();
    var component = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Checkbox["default"], {
      label: "Checkbox",
      checked: false,
      onChange: onChange,
      name: "test"
    }));
    var input = component.getByRole("checkbox");
    var visibleCheckbox = component.getByText("Checkbox");
    var submitInput = component.container.querySelector("input[name=\"test\"]");

    _react2.fireEvent.click(visibleCheckbox);

    expect(onChange).toHaveBeenCalled();
    expect(onChange).toHaveBeenCalledWith(true);
    expect(input.getAttribute("aria-checked")).toBe("false");
    expect(submitInput.checked).toBe(false);
  });
  test("Renders with correct initial value and initial state when it is uncontrolled", function () {
    var _render4 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Checkbox["default"], {
      label: "Default label",
      defaultChecked: true,
      value: "test-defaultChecked",
      name: "test"
    })),
        getByRole = _render4.getByRole,
        container = _render4.container;

    var checkbox = getByRole("checkbox");
    var submitInput = container.querySelector("input[name=\"test\"]");
    expect(submitInput.value).toBe("test-defaultChecked");
    expect(checkbox.getAttribute("aria-checked")).toBe("true");
    expect(submitInput.checked).toBe(true);
  });
  test("Test disable keyboard and mouse interactions", function () {
    var onChange = jest.fn();

    var _render5 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Checkbox["default"], {
      label: "Checkbox",
      onChange: onChange,
      disabled: true,
      name: "test"
    })),
        getByRole = _render5.getByRole,
        getByText = _render5.getByText,
        container = _render5.container;

    var input = getByRole("checkbox");
    var visibleCheckbox = getByText("Checkbox");
    var submitInput = container.querySelector("input[name=\"test\"]");

    _react2.fireEvent.click(visibleCheckbox);

    expect(onChange).toHaveBeenCalledTimes(0);
    expect(input.getAttribute("aria-checked")).toBe("false");
    expect(input.getAttribute("aria-disabled")).toBe("true");
    expect(submitInput.checked).toBe(false);

    _userEvent["default"].tab();

    expect(document.activeElement === input).toBeFalsy();
  });
  test("Test keyboard interactions", function () {
    var onChange = jest.fn();

    var _render6 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Checkbox["default"], {
      label: "Checkbox",
      name: "test",
      onChange: onChange
    })),
        getByRole = _render6.getByRole;

    var checkbox = getByRole("checkbox");

    _userEvent["default"].tab();

    expect(document.activeElement === checkbox).toBeTruthy();

    _react2.fireEvent.keyDown(checkbox, {
      key: " ",
      code: "Space",
      keyCode: 32,
      charCode: 32
    });

    expect(onChange).toHaveBeenCalledWith(true);
  });
});